pipeline {
	agent any
	tools {
		maven "maven"
	}
	stages {
		stage ('Check ENV') {
			steps {
				sh "mvn -v"
				sh "java -version"
			}
		}
		
		stage ('mvn clean') {
            steps{
                cd spring/spring-project-backend 
				mvn clean
            }
		}
		stage ('Test project') {
			steps {
				sh "mvn test"
			}
		}
		stage ('Build project') {
			steps {
			    /usr/local/tomcat/bin/shutdown.sh
				sh "mvn package"
			    /usr/local/tomcat/bin/deploy.sh
			}
		}
	}
	post{
	    always{
			/usr/local/tomcat/bin/startup.sh
	    }
	}
}